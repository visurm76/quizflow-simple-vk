{"version":3,"sources":["../../../src/components/WriteBar/WriteBar.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useMergeProps } from '../../hooks/useMergeProps';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { warnOnce } from '../../lib/warnOnce';\nimport type { HasDataAttribute, HasRootRef } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { useResizeTextarea } from '../Textarea/useResizeTextarea';\nimport { Headline } from '../Typography/Headline/Headline';\nimport { Title } from '../Typography/Title/Title';\nimport type { TypographyProps } from '../Typography/Typography';\nimport styles from './WriteBar.module.css';\n\nconst warn = warnOnce('WriteBar');\n\nexport interface WriteBarProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRootRef<HTMLDivElement> {\n  /**\n   * @deprecated Since 7.9.0. Вместо этого используйте `slotProps={ textArea: { getRootRef: ... } }`.\n   */\n  getRef?: React.Ref<HTMLTextAreaElement>;\n  /**\n   * Свойства, которые можно прокинуть внутрь компонента:\n   * - `root`: свойства для прокидывания в корень компонента;\n   * - `textArea`: свойства для прокидывания в поле ввода.\n   */\n  slotProps?: {\n    root?: Omit<React.HTMLAttributes<HTMLDivElement>, 'children'> &\n      HasRootRef<HTMLDivElement> &\n      HasDataAttribute;\n    textArea?: React.TextareaHTMLAttributes<HTMLTextAreaElement> &\n      HasRootRef<HTMLTextAreaElement> &\n      HasDataAttribute;\n  };\n  /**\n   * Содержимое, отображаемое слева от поля ввода.\n   */\n  before?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое поверх поля ввода (актуально для iOS).\n   */\n  inlineAfter?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое справа от поля ввода.\n   */\n  after?: React.ReactNode;\n  /**\n   * Вызывается при смене высоты поля ввода.\n   */\n  onHeightChange?: VoidFunction;\n  /**\n   * Добавляет тень вокруг поля ввода.\n   */\n  shadow?: boolean;\n  /**\n   * @deprecated Неиспользуемое свойство.\n   */\n  children?: never;\n}\n\nconst WriteBarTypography = (props: TypographyProps) => {\n  const platform = usePlatform();\n\n  if (platform === 'ios') {\n    return <Title {...props} level=\"3\" weight=\"3\" />;\n  }\n\n  return <Headline weight=\"3\" {...props} />;\n};\n\n/**\n * @see https://vkui.io/components/write-bar\n */\nexport const WriteBar = ({\n  className,\n  style,\n  before,\n  inlineAfter,\n  after,\n  getRootRef,\n  getRef,\n  onHeightChange,\n  shadow = false,\n\n  slotProps,\n  ...restProps\n}: WriteBarProps): React.ReactNode => {\n  /* istanbul ignore if: не проверяем в тестах */\n  if (process.env.NODE_ENV === 'development' && getRef) {\n    warn('Свойство `getRef` устаревшее, используйте `slotProps={ textArea: { getRootRef: ... } }`');\n  }\n\n  const platform = usePlatform();\n\n  const rootProps = useMergeProps(\n    {\n      className,\n      getRootRef,\n      style,\n    },\n    slotProps?.root,\n  );\n\n  const {\n    onChange,\n    getRootRef: getTextAreaRef,\n    ...textAreaRest\n  } = useMergeProps(\n    {\n      className: styles.textarea,\n      getRootRef: getRef,\n      ...restProps,\n    },\n    slotProps?.textArea,\n  );\n\n  const [refResizeTextarea, resize] = useResizeTextarea(onHeightChange, true);\n  const textareaRef = useExternRef(getTextAreaRef, refResizeTextarea);\n\n  React.useEffect(resize, [resize, platform]);\n\n  return (\n    <RootComponent\n      baseClassName={classNames(\n        styles.host,\n        platform === 'ios' && styles.ios,\n        shadow && styles.shadow,\n      )}\n      {...rootProps}\n    >\n      <div className={styles.form}>\n        {hasReactNode(before) && <div className={styles.before}>{before}</div>}\n\n        <div className={styles.formIn}>\n          <WriteBarTypography\n            Component=\"textarea\"\n            onChange={callMultiple(onChange, resize)}\n            getRootRef={textareaRef}\n            {...textAreaRest}\n          />\n          {hasReactNode(inlineAfter) && <div className={styles.inlineAfter}>{inlineAfter}</div>}\n        </div>\n\n        {hasReactNode(after) && <div className={styles.after}>{after}</div>}\n      </div>\n    </RootComponent>\n  );\n};\n"],"names":["React","classNames","hasReactNode","useExternRef","useMergeProps","usePlatform","callMultiple","warnOnce","RootComponent","useResizeTextarea","Headline","Title","warn","WriteBarTypography","props","platform","level","weight","WriteBar","className","style","before","inlineAfter","after","getRootRef","getRef","onHeightChange","shadow","slotProps","restProps","process","env","NODE_ENV","rootProps","root","textArea","onChange","getTextAreaRef","textAreaRest","refResizeTextarea","resize","textareaRef","useEffect","baseClassName","div","Component"],"mappings":"AAAA;;;;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,EAAEC,YAAY,QAAQ,kBAAkB;AAC3D,SAASC,YAAY,QAAQ,8BAA2B;AACxD,SAASC,aAAa,QAAQ,+BAA4B;AAC1D,SAASC,WAAW,QAAQ,6BAA0B;AACtD,SAASC,YAAY,QAAQ,4BAAyB;AACtD,SAASC,QAAQ,QAAQ,wBAAqB;AAE9C,SAASC,aAAa,QAAQ,oCAAiC;AAC/D,SAASC,iBAAiB,QAAQ,mCAAgC;AAClE,SAASC,QAAQ,QAAQ,qCAAkC;AAC3D,SAASC,KAAK,QAAQ,+BAA4B;AAIlD,MAAMC,OAAOL,SAAS;AAgDtB,MAAMM,qBAAqB,CAACC;IAC1B,MAAMC,WAAWV;IAEjB,IAAIU,aAAa,OAAO;QACtB,qBAAO,KAACJ,+CAAUG;YAAOE,OAAM;YAAIC,QAAO;;IAC5C;IAEA,qBAAO,KAACP;QAASO,QAAO;OAAQH;AAClC;AAEA;;CAEC,GACD,OAAO,MAAMI,WAAW;QAAC,EACvBC,SAAS,EACTC,KAAK,EACLC,MAAM,EACNC,WAAW,EACXC,KAAK,EACLC,UAAU,EACVC,MAAM,EACNC,cAAc,EACdC,SAAS,KAAK,EAEdC,SAAS,EAEK,WADXC;QAXHV;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QAEAC;;IAGA,6CAA6C,GAC7C,IAAIE,QAAQC,GAAG,CAACC,QAAQ,KAAK,iBAAiBP,QAAQ;QACpDb,KAAK;IACP;IAEA,MAAMG,WAAWV;IAEjB,MAAM4B,YAAY7B,cAChB;QACEe;QACAK;QACAJ;IACF,GACAQ,sBAAAA,gCAAAA,UAAWM,IAAI;IAGjB,MAII9B,iBAAAA,cACF;QACEe,SAAS;QACTK,YAAYC;OACTI,YAELD,sBAAAA,gCAAAA,UAAWO,QAAQ,GAVf,EACJC,QAAQ,EACRZ,YAAYa,cAAc,EAE3B,GAAGjC,gBADCkC,0CACDlC;QAHFgC;QACAZ;;IAWF,MAAM,CAACe,mBAAmBC,OAAO,GAAG/B,kBAAkBiB,gBAAgB;IACtE,MAAMe,cAActC,aAAakC,gBAAgBE;IAEjDvC,MAAM0C,SAAS,CAACF,QAAQ;QAACA;QAAQzB;KAAS;IAE1C,qBACE,KAACP;QACCmC,eAAe1C,iCAEbc,aAAa,8BACbY;OAEEM;kBAEJ,cAAA,MAACW;YAAIzB,SAAS;;gBACXjB,aAAamB,yBAAW,KAACuB;oBAAIzB,SAAS;8BAAkBE;;8BAEzD,MAACuB;oBAAIzB,SAAS;;sCACZ,KAACN;4BACCgC,WAAU;4BACVT,UAAU9B,aAAa8B,UAAUI;4BACjChB,YAAYiB;2BACRH;wBAELpC,aAAaoB,8BAAgB,KAACsB;4BAAIzB,SAAS;sCAAuBG;;;;gBAGpEpB,aAAaqB,wBAAU,KAACqB;oBAAIzB,SAAS;8BAAiBI;;;;;AAI/D,EAAE"}