{"version":3,"sources":["../../../src/components/Switch/Switch.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useConfigDirection } from '../../hooks/useConfigDirection';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { useFocusVisibleClassName } from '../../hooks/useFocusVisibleClassName';\nimport { useMergeProps } from '../../hooks/useMergeProps';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { warnOnce } from '../../lib/warnOnce';\nimport type { HasDataAttribute, HasRootRef } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { VisuallyHidden, type VisuallyHiddenProps } from '../VisuallyHidden/VisuallyHidden';\nimport styles from './Switch.module.css';\n\nconst warn = warnOnce('Switch');\n\nconst sizeYClassNames = {\n  none: styles.sizeYNone,\n  compact: styles.sizeYCompact,\n};\n\nexport interface SwitchProps\n  extends React.InputHTMLAttributes<HTMLInputElement>,\n    HasRootRef<HTMLLabelElement> {\n  /**\n   * Свойства, которые можно прокинуть внутрь компонента:\n   * - `root`: свойства для прокидывания в корень компонента;\n   * - `input`: свойства для прокидывания в скрытый `input`.\n   */\n  slotProps?: {\n    root?: Omit<React.LabelHTMLAttributes<HTMLLabelElement>, 'children'> &\n      HasRootRef<HTMLLabelElement> &\n      HasDataAttribute;\n    input?: React.InputHTMLAttributes<HTMLInputElement> &\n      HasRootRef<HTMLInputElement> &\n      HasDataAttribute;\n  };\n  /**\n   * @deprecated Since 7.9.0. Вместо этого используйте `slotProps={ input: { getRootRef: ... } }`.\n   */\n  getRef?: React.Ref<HTMLInputElement>;\n}\n\n/**\n * @see https://vkui.io/components/switch\n */\nexport const Switch = ({\n  style: rootStyle,\n  className: rootClassName,\n  getRootRef: rootGetRootRef,\n  getRef,\n  slotProps,\n  ...restProps\n}: SwitchProps): React.ReactNode => {\n  /* istanbul ignore if: не проверяем в тестах */\n  if (process.env.NODE_ENV === 'development' && getRef) {\n    warn('Свойство `getRef` устаревшее, используйте `slotProps={ input: { getRootRef: ... } }`');\n  }\n\n  const rootRest = useMergeProps(\n    {\n      style: rootStyle,\n      className: rootClassName,\n      getRootRef: rootGetRootRef,\n    },\n    slotProps?.root,\n  );\n  const {\n    checked: checkedProp,\n    onBlur: onBlurProp,\n    onFocus: onFocusProp,\n    onClick,\n    ...inputRest\n  } = useMergeProps({ getRootRef: getRef, ...restProps }, slotProps?.input);\n\n  const direction = useConfigDirection();\n  const isRtl = direction === 'rtl';\n  const platform = usePlatform();\n  const { sizeY = 'none' } = useAdaptivity();\n  const { focusVisible, onBlur, onFocus } = useFocusVisible();\n  const focusVisibleClassNames = useFocusVisibleClassName({ focusVisible, mode: 'outside' });\n  const handleBlur = callMultiple(onBlur, onBlurProp);\n  const handleFocus = callMultiple(onFocus, onFocusProp);\n\n  const [localUncontrolledChecked, setLocalUncontrolledChecked] = React.useState(\n    Boolean(inputRest.defaultChecked),\n  );\n  const isControlled = checkedProp !== undefined;\n\n  const syncUncontrolledCheckedStateOnClick = React.useCallback(\n    (e: React.MouseEvent<HTMLInputElement>) => {\n      if (isControlled) {\n        return;\n      }\n\n      const switchTarget = e.target as HTMLInputElement;\n      setLocalUncontrolledChecked(switchTarget.checked);\n    },\n    [isControlled],\n  );\n\n  const inputProps: VisuallyHiddenProps<HTMLInputElement> = {\n    Component: 'input',\n    type: 'checkbox',\n    role: 'switch',\n    onBlur: handleBlur,\n    onFocus: handleFocus,\n    onClick: callMultiple(syncUncontrolledCheckedStateOnClick, onClick),\n    ...inputRest,\n  };\n\n  if (isControlled) {\n    inputProps.checked = checkedProp;\n    inputProps['aria-checked'] = checkedProp ? 'true' : 'false';\n  } else {\n    inputProps['aria-checked'] = localUncontrolledChecked ? 'true' : 'false';\n  }\n\n  return (\n    <RootComponent\n      Component=\"label\"\n      baseClassName={classNames(\n        styles.host,\n        sizeY !== 'regular' && sizeYClassNames[sizeY],\n        platform === 'ios' ? styles.ios : styles.default,\n        inputRest.disabled && styles.disabled,\n        isRtl && styles.rtl,\n        focusVisibleClassNames,\n      )}\n      {...rootRest}\n    >\n      <VisuallyHidden baseClassName={styles.inputNative} {...inputProps} />\n      <span aria-hidden className={styles.inputFake}>\n        <span className={styles.track} />\n        <span\n          aria-hidden\n          className={classNames(\n            styles.handle,\n            platform !== 'ios' && !inputRest.disabled && styles.handleWithRipple,\n          )}\n        />\n      </span>\n    </RootComponent>\n  );\n};\n"],"names":["React","classNames","useAdaptivity","useConfigDirection","useFocusVisible","useFocusVisibleClassName","useMergeProps","usePlatform","callMultiple","warnOnce","RootComponent","VisuallyHidden","warn","sizeYClassNames","none","compact","Switch","style","rootStyle","className","rootClassName","getRootRef","rootGetRootRef","getRef","slotProps","restProps","process","env","NODE_ENV","rootRest","root","input","checked","checkedProp","onBlur","onBlurProp","onFocus","onFocusProp","onClick","inputRest","direction","isRtl","platform","sizeY","focusVisible","focusVisibleClassNames","mode","handleBlur","handleFocus","localUncontrolledChecked","setLocalUncontrolledChecked","useState","Boolean","defaultChecked","isControlled","undefined","syncUncontrolledCheckedStateOnClick","useCallback","e","switchTarget","target","inputProps","Component","type","role","baseClassName","disabled","span","aria-hidden"],"mappings":"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"}