{"version":3,"sources":["../../../../src/lib/touch/UIPanGestureRecognizer.ts"],"sourcesContent":["import { millisecondsInSecond } from '../date';\nimport { getFirstTouchEventData } from '../dom';\n\nexport type Direction = { axis: 'x' | 'y'; direction: -1 | 1 | null };\n\nexport type Coords = { x: number; y: number };\n\nconst DEFAULT_INITIAL_TIME = 0;\n\n/**\n * JS имплементация класса из UIKIt iOS.\n *\n * https://developer.apple.com/documentation/uikit/uipangesturerecognizer\n */\nexport class UIPanGestureRecognizer {\n  private initialTime = DEFAULT_INITIAL_TIME;\n  x1 = 0;\n  y1 = 0;\n  x2 = 0;\n  y2 = 0;\n\n  setInitialTimeOnce(): void {\n    if (this.initialTime === DEFAULT_INITIAL_TIME) {\n      this.initialTime = Date.now();\n    }\n  }\n\n  setStartCoords(event: UIEvent): void {\n    const { clientX, clientY } = getFirstTouchEventData(event);\n    this.x1 = clientX;\n    this.y1 = clientY;\n  }\n\n  setEndCoords(event: UIEvent): void {\n    const { clientX, clientY } = getFirstTouchEventData(event);\n    this.x2 = clientX;\n    this.y2 = clientY;\n  }\n\n  delta(): Coords {\n    return {\n      x: this.x2 - this.x1,\n      y: this.y2 - this.y1,\n    };\n  }\n\n  distance(): number {\n    const { x, y } = this.delta();\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n  }\n\n  velocity(): Coords {\n    const deltaTime = (Date.now() - this.initialTime) / millisecondsInSecond;\n\n    if (deltaTime <= 0) {\n      return { x: 0, y: 0 };\n    }\n\n    const { x, y } = this.delta();\n    return { x: x / deltaTime, y: y / deltaTime };\n  }\n\n  angle(): number {\n    const deltaX = this.x2 - this.x1;\n    const deltaY = this.y2 - this.y1;\n    const radians = Math.atan2(deltaY, deltaX);\n    const degrees = (radians * 180) / Math.PI;\n    return degrees < 0 ? 360 + degrees : degrees;\n  }\n\n  direction(): Direction {\n    const { x, y } = this.delta();\n    return Math.abs(x) > Math.abs(y)\n      ? { axis: 'x', direction: x > 0 ? 1 : x < 0 ? -1 : null }\n      : { axis: 'y', direction: y > 0 ? 1 : y < 0 ? -1 : null };\n  }\n\n  reset(): void {\n    this.initialTime = DEFAULT_INITIAL_TIME;\n    this.x1 = this.y1 = 0;\n    this.x2 = this.y2 = 0;\n  }\n}\n"],"names":["millisecondsInSecond","getFirstTouchEventData","DEFAULT_INITIAL_TIME","UIPanGestureRecognizer","initialTime","x1","y1","x2","y2","setInitialTimeOnce","Date","now","setStartCoords","event","clientX","clientY","setEndCoords","delta","x","y","distance","Math","sqrt","pow","velocity","deltaTime","angle","deltaX","deltaY","radians","atan2","degrees","PI","direction","abs","axis","reset"],"mappings":"AAAA,SAASA,oBAAoB,QAAQ,aAAU;AAC/C,SAASC,sBAAsB,QAAQ,YAAS;AAMhD,MAAMC,uBAAuB;AAE7B;;;;CAIC,GACD,OAAO,MAAMC;IACHC,cAAcF,qBAAqB;IAC3CG,KAAK,EAAE;IACPC,KAAK,EAAE;IACPC,KAAK,EAAE;IACPC,KAAK,EAAE;IAEPC,qBAA2B;QACzB,IAAI,IAAI,CAACL,WAAW,KAAKF,sBAAsB;YAC7C,IAAI,CAACE,WAAW,GAAGM,KAAKC,GAAG;QAC7B;IACF;IAEAC,eAAeC,KAAc,EAAQ;QACnC,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE,GAAGd,uBAAuBY;QACpD,IAAI,CAACR,EAAE,GAAGS;QACV,IAAI,CAACR,EAAE,GAAGS;IACZ;IAEAC,aAAaH,KAAc,EAAQ;QACjC,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE,GAAGd,uBAAuBY;QACpD,IAAI,CAACN,EAAE,GAAGO;QACV,IAAI,CAACN,EAAE,GAAGO;IACZ;IAEAE,QAAgB;QACd,OAAO;YACLC,GAAG,IAAI,CAACX,EAAE,GAAG,IAAI,CAACF,EAAE;YACpBc,GAAG,IAAI,CAACX,EAAE,GAAG,IAAI,CAACF,EAAE;QACtB;IACF;IAEAc,WAAmB;QACjB,MAAM,EAAEF,CAAC,EAAEC,CAAC,EAAE,GAAG,IAAI,CAACF,KAAK;QAC3B,OAAOI,KAAKC,IAAI,CAACD,KAAKE,GAAG,CAACL,GAAG,KAAKG,KAAKE,GAAG,CAACJ,GAAG;IAChD;IAEAK,WAAmB;QACjB,MAAMC,YAAY,AAACf,CAAAA,KAAKC,GAAG,KAAK,IAAI,CAACP,WAAW,AAAD,IAAKJ;QAEpD,IAAIyB,aAAa,GAAG;YAClB,OAAO;gBAAEP,GAAG;gBAAGC,GAAG;YAAE;QACtB;QAEA,MAAM,EAAED,CAAC,EAAEC,CAAC,EAAE,GAAG,IAAI,CAACF,KAAK;QAC3B,OAAO;YAAEC,GAAGA,IAAIO;YAAWN,GAAGA,IAAIM;QAAU;IAC9C;IAEAC,QAAgB;QACd,MAAMC,SAAS,IAAI,CAACpB,EAAE,GAAG,IAAI,CAACF,EAAE;QAChC,MAAMuB,SAAS,IAAI,CAACpB,EAAE,GAAG,IAAI,CAACF,EAAE;QAChC,MAAMuB,UAAUR,KAAKS,KAAK,CAACF,QAAQD;QACnC,MAAMI,UAAU,AAACF,UAAU,MAAOR,KAAKW,EAAE;QACzC,OAAOD,UAAU,IAAI,MAAMA,UAAUA;IACvC;IAEAE,YAAuB;QACrB,MAAM,EAAEf,CAAC,EAAEC,CAAC,EAAE,GAAG,IAAI,CAACF,KAAK;QAC3B,OAAOI,KAAKa,GAAG,CAAChB,KAAKG,KAAKa,GAAG,CAACf,KAC1B;YAAEgB,MAAM;YAAKF,WAAWf,IAAI,IAAI,IAAIA,IAAI,IAAI,CAAC,IAAI;QAAK,IACtD;YAAEiB,MAAM;YAAKF,WAAWd,IAAI,IAAI,IAAIA,IAAI,IAAI,CAAC,IAAI;QAAK;IAC5D;IAEAiB,QAAc;QACZ,IAAI,CAAChC,WAAW,GAAGF;QACnB,IAAI,CAACG,EAAE,GAAG,IAAI,CAACC,EAAE,GAAG;QACpB,IAAI,CAACC,EAAE,GAAG,IAAI,CAACC,EAAE,GAAG;IACtB;AACF"}