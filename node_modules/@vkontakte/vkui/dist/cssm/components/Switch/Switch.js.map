{"version":3,"sources":["../../../../src/components/Switch/Switch.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useConfigDirection } from '../../hooks/useConfigDirection';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { useFocusVisibleClassName } from '../../hooks/useFocusVisibleClassName';\nimport { useMergeProps } from '../../hooks/useMergeProps';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { warnOnce } from '../../lib/warnOnce';\nimport type { HasDataAttribute, HasRootRef } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { VisuallyHidden, type VisuallyHiddenProps } from '../VisuallyHidden/VisuallyHidden';\nimport styles from './Switch.module.css';\n\nconst warn = warnOnce('Switch');\n\nconst sizeYClassNames = {\n  none: styles.sizeYNone,\n  compact: styles.sizeYCompact,\n};\n\nexport interface SwitchProps\n  extends React.InputHTMLAttributes<HTMLInputElement>,\n    HasRootRef<HTMLLabelElement> {\n  /**\n   * Свойства, которые можно прокинуть внутрь компонента:\n   * - `root`: свойства для прокидывания в корень компонента;\n   * - `input`: свойства для прокидывания в скрытый `input`.\n   */\n  slotProps?: {\n    root?: Omit<React.LabelHTMLAttributes<HTMLLabelElement>, 'children'> &\n      HasRootRef<HTMLLabelElement> &\n      HasDataAttribute;\n    input?: React.InputHTMLAttributes<HTMLInputElement> &\n      HasRootRef<HTMLInputElement> &\n      HasDataAttribute;\n  };\n  /**\n   * @deprecated Since 7.9.0. Вместо этого используйте `slotProps={ input: { getRootRef: ... } }`.\n   */\n  getRef?: React.Ref<HTMLInputElement>;\n}\n\n/**\n * @see https://vkui.io/components/switch\n */\nexport const Switch = ({\n  style: rootStyle,\n  className: rootClassName,\n  getRootRef: rootGetRootRef,\n  getRef,\n  slotProps,\n  ...restProps\n}: SwitchProps): React.ReactNode => {\n  /* istanbul ignore if: не проверяем в тестах */\n  if (process.env.NODE_ENV === 'development' && getRef) {\n    warn('Свойство `getRef` устаревшее, используйте `slotProps={ input: { getRootRef: ... } }`');\n  }\n\n  const rootRest = useMergeProps(\n    {\n      style: rootStyle,\n      className: rootClassName,\n      getRootRef: rootGetRootRef,\n    },\n    slotProps?.root,\n  );\n  const {\n    checked: checkedProp,\n    onBlur: onBlurProp,\n    onFocus: onFocusProp,\n    onClick,\n    ...inputRest\n  } = useMergeProps({ getRootRef: getRef, ...restProps }, slotProps?.input);\n\n  const direction = useConfigDirection();\n  const isRtl = direction === 'rtl';\n  const platform = usePlatform();\n  const { sizeY = 'none' } = useAdaptivity();\n  const { focusVisible, onBlur, onFocus } = useFocusVisible();\n  const focusVisibleClassNames = useFocusVisibleClassName({ focusVisible, mode: 'outside' });\n  const handleBlur = callMultiple(onBlur, onBlurProp);\n  const handleFocus = callMultiple(onFocus, onFocusProp);\n\n  const [localUncontrolledChecked, setLocalUncontrolledChecked] = React.useState(\n    Boolean(inputRest.defaultChecked),\n  );\n  const isControlled = checkedProp !== undefined;\n\n  const syncUncontrolledCheckedStateOnClick = React.useCallback(\n    (e: React.MouseEvent<HTMLInputElement>) => {\n      if (isControlled) {\n        return;\n      }\n\n      const switchTarget = e.target as HTMLInputElement;\n      setLocalUncontrolledChecked(switchTarget.checked);\n    },\n    [isControlled],\n  );\n\n  const inputProps: VisuallyHiddenProps<HTMLInputElement> = {\n    Component: 'input',\n    type: 'checkbox',\n    role: 'switch',\n    onBlur: handleBlur,\n    onFocus: handleFocus,\n    onClick: callMultiple(syncUncontrolledCheckedStateOnClick, onClick),\n    ...inputRest,\n  };\n\n  if (isControlled) {\n    inputProps.checked = checkedProp;\n    inputProps['aria-checked'] = checkedProp ? 'true' : 'false';\n  } else {\n    inputProps['aria-checked'] = localUncontrolledChecked ? 'true' : 'false';\n  }\n\n  return (\n    <RootComponent\n      Component=\"label\"\n      baseClassName={classNames(\n        styles.host,\n        sizeY !== 'regular' && sizeYClassNames[sizeY],\n        platform === 'ios' ? styles.ios : styles.default,\n        inputRest.disabled && styles.disabled,\n        isRtl && styles.rtl,\n        focusVisibleClassNames,\n      )}\n      {...rootRest}\n    >\n      <VisuallyHidden baseClassName={styles.inputNative} {...inputProps} />\n      <span aria-hidden className={styles.inputFake}>\n        <span className={styles.track} />\n        <span\n          aria-hidden\n          className={classNames(\n            styles.handle,\n            platform !== 'ios' && !inputRest.disabled && styles.handleWithRipple,\n          )}\n        />\n      </span>\n    </RootComponent>\n  );\n};\n"],"names":["React","classNames","useAdaptivity","useConfigDirection","useFocusVisible","useFocusVisibleClassName","useMergeProps","usePlatform","callMultiple","warnOnce","RootComponent","VisuallyHidden","styles","warn","sizeYClassNames","none","sizeYNone","compact","sizeYCompact","Switch","style","rootStyle","className","rootClassName","getRootRef","rootGetRootRef","getRef","slotProps","restProps","process","env","NODE_ENV","rootRest","root","checked","checkedProp","onBlur","onBlurProp","onFocus","onFocusProp","onClick","inputRest","input","direction","isRtl","platform","sizeY","focusVisible","focusVisibleClassNames","mode","handleBlur","handleFocus","localUncontrolledChecked","setLocalUncontrolledChecked","useState","Boolean","defaultChecked","isControlled","undefined","syncUncontrolledCheckedStateOnClick","useCallback","e","switchTarget","target","inputProps","Component","type","role","baseClassName","host","ios","default","disabled","rtl","inputNative","span","aria-hidden","inputFake","track","handle","handleWithRipple"],"mappings":"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"}