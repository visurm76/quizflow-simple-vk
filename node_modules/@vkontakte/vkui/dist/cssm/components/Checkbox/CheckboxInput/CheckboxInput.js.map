{"version":3,"sources":["../../../../../src/components/Checkbox/CheckboxInput/CheckboxInput.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport {\n  Icon20CheckBoxIndetermanate,\n  Icon20CheckBoxOff,\n  Icon20CheckBoxOn,\n  Icon24CheckBoxOff,\n  Icon24CheckBoxOn,\n} from '@vkontakte/icons';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivityConditionalRender } from '../../../hooks/useAdaptivityConditionalRender';\nimport { useExternRef } from '../../../hooks/useExternRef';\nimport { useMergeProps } from '../../../hooks/useMergeProps';\nimport { usePlatform } from '../../../hooks/usePlatform';\nimport { warnOnce } from '../../../lib/warnOnce';\nimport type { HasDataAttribute, HasRootRef } from '../../../types';\nimport { RootComponent } from '../../RootComponent/RootComponent';\nimport { VisuallyHidden } from '../../VisuallyHidden/VisuallyHidden';\nimport styles from './CheckboxInput.module.css';\n\ntype VendorIconType = typeof Icon20CheckBoxOn;\n\nexport type CheckboxInputIconType =\n  | React.ComponentType<React.SVGProps<SVGSVGElement>>\n  | VendorIconType;\n\nfunction setIndeterminate(el: HTMLInputElement, indeterminate: boolean) {\n  el.indeterminate = indeterminate;\n}\n\nexport interface CheckboxInputProps\n  extends React.ComponentProps<'input'>,\n    HasRootRef<HTMLDivElement> {\n  /**\n   * @deprecated Since 7.9.0. Вместо этого используйте `slotProps={ input: { getRootRef: ... } }`.\n   */\n  getRef?: React.Ref<HTMLInputElement>;\n  /**\n   * Свойства, которые можно прокинуть внутрь компонента:\n   * - `root`: свойства для прокидывания в корень компонента;\n   * - `input`: свойства для прокидывания в скрытый `input`.\n   */\n  slotProps?: {\n    root?: Omit<React.HTMLAttributes<HTMLDivElement>, 'children'> &\n      HasRootRef<HTMLDivElement> &\n      HasDataAttribute;\n    input?: React.ComponentProps<'input'> & HasRootRef<HTMLInputElement> & HasDataAttribute;\n  };\n  /**\n   * Неопределенное состояние чекбокса.\n   */\n  indeterminate?: boolean;\n  /**\n   * Неопределенное состояние чекбокса по умолчанию.\n   */\n  defaultIndeterminate?: boolean;\n  /**\n   * Иконка для включенного состояния в компактном режиме.\n   */\n  IconOnCompact?: CheckboxInputIconType;\n  /**\n   * Иконка для включенного состояния в обычном режиме.\n   */\n  IconOnRegular?: CheckboxInputIconType;\n  /**\n   * Иконка для выключенного состояния в компактном режиме.\n   */\n  IconOffCompact?: CheckboxInputIconType;\n  /**\n   * Иконка для выключенного состояния в обычном режиме.\n   */\n  IconOffRegular?: CheckboxInputIconType;\n  /**\n   * Иконка для неопределенного состояния.\n   */\n  IconIndeterminate?: CheckboxInputIconType;\n}\n\nconst warn = warnOnce('Checkbox');\n\nexport function CheckboxInput({\n  className,\n  style,\n  getRootRef,\n  getRef,\n\n  indeterminate,\n  defaultIndeterminate,\n  IconOnCompact = Icon20CheckBoxOn,\n  IconOnRegular = Icon24CheckBoxOn,\n  IconOffCompact = Icon20CheckBoxOff,\n  IconOffRegular = Icon24CheckBoxOff,\n  IconIndeterminate = Icon20CheckBoxIndetermanate,\n\n  slotProps,\n  ...restProps\n}: CheckboxInputProps) {\n  const rootRest = useMergeProps(\n    {\n      className,\n      style,\n      getRootRef,\n    },\n    slotProps?.root,\n  );\n\n  const {\n    onChange,\n    getRootRef: getInputRef,\n    ...inputRest\n  } = useMergeProps({ getRootRef: getRef, ...restProps }, slotProps?.input);\n\n  const inputRef = useExternRef<HTMLInputElement>(getInputRef);\n\n  const platform = usePlatform();\n  const { sizeY: adaptiveSizeY } = useAdaptivityConditionalRender();\n\n  React.useEffect(() => {\n    const indeterminateValue = indeterminate === undefined ? defaultIndeterminate : indeterminate;\n\n    if (inputRef.current) {\n      setIndeterminate(inputRef.current, Boolean(indeterminateValue));\n    }\n  }, [defaultIndeterminate, indeterminate, inputRef]);\n\n  const handleChange = React.useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      if (\n        defaultIndeterminate !== undefined &&\n        indeterminate === undefined &&\n        inputRest.checked === undefined &&\n        inputRef.current\n      ) {\n        setIndeterminate(inputRef.current, false);\n      }\n      if (indeterminate !== undefined && inputRef.current) {\n        setIndeterminate(inputRef.current, Boolean(indeterminate));\n      }\n      onChange && onChange(event);\n    },\n    [defaultIndeterminate, indeterminate, inputRest.checked, onChange, inputRef],\n  );\n\n  if (process.env.NODE_ENV === 'development') {\n    /* istanbul ignore if: не проверяем в тестах */\n    if (getRef) {\n      warn('Свойство `getRef` устаревшее, используйте `slotProps={ input: { getRootRef: ... } }`');\n    }\n\n    if (defaultIndeterminate && inputRest.defaultChecked) {\n      warn('defaultIndeterminate и defaultChecked не могут быть true одновременно', 'error');\n    }\n\n    if (indeterminate && inputRest.checked) {\n      warn('indeterminate и checked не могут быть true одновременно', 'error');\n    }\n\n    if (inputRest.defaultChecked && inputRest.checked) {\n      warn('defaultChecked и checked не могут быть true одновременно', 'error');\n    }\n  }\n\n  return (\n    <RootComponent baseClassName={styles.host} {...rootRest}>\n      <VisuallyHidden\n        Component=\"input\"\n        type=\"checkbox\"\n        onChange={handleChange}\n        getRootRef={inputRef}\n        baseClassName={styles.input}\n        {...inputRest}\n      />\n      {platform === 'vkcom' ? (\n        <IconOnCompact className={styles.iconOn} />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <IconOnCompact className={classNames(styles.iconOn, adaptiveSizeY.compact.className)} />\n          )}\n          {adaptiveSizeY.regular && (\n            <IconOnRegular className={classNames(styles.iconOn, adaptiveSizeY.regular.className)} />\n          )}\n        </React.Fragment>\n      )}\n      {platform === 'vkcom' ? (\n        <IconOffCompact className={styles.iconOff} />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <IconOffCompact\n              className={classNames(styles.iconOff, adaptiveSizeY.compact.className)}\n            />\n          )}\n          {adaptiveSizeY.regular && (\n            <IconOffRegular\n              className={classNames(styles.iconOff, adaptiveSizeY.regular.className)}\n            />\n          )}\n        </React.Fragment>\n      )}\n      {platform === 'vkcom' ? (\n        <IconIndeterminate width={20} height={20} className={styles.iconIndeterminate} />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <IconIndeterminate\n              className={classNames(styles.iconIndeterminate, adaptiveSizeY.compact.className)}\n              width={20}\n              height={20}\n            />\n          )}\n          {adaptiveSizeY.regular && (\n            <IconIndeterminate\n              className={classNames(styles.iconIndeterminate, adaptiveSizeY.regular.className)}\n              width={24}\n              height={24}\n            />\n          )}\n        </React.Fragment>\n      )}\n    </RootComponent>\n  );\n}\n"],"names":["React","Icon20CheckBoxIndetermanate","Icon20CheckBoxOff","Icon20CheckBoxOn","Icon24CheckBoxOff","Icon24CheckBoxOn","classNames","useAdaptivityConditionalRender","useExternRef","useMergeProps","usePlatform","warnOnce","RootComponent","VisuallyHidden","styles","setIndeterminate","el","indeterminate","warn","CheckboxInput","className","style","getRootRef","getRef","defaultIndeterminate","IconOnCompact","IconOnRegular","IconOffCompact","IconOffRegular","IconIndeterminate","slotProps","restProps","rootRest","root","onChange","getInputRef","inputRest","input","inputRef","platform","sizeY","adaptiveSizeY","useEffect","indeterminateValue","undefined","current","Boolean","handleChange","useCallback","event","checked","process","env","NODE_ENV","defaultChecked","baseClassName","host","Component","type","iconOn","Fragment","compact","regular","iconOff","width","height","iconIndeterminate"],"mappings":"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"}