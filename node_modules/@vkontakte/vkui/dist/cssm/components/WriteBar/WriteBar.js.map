{"version":3,"sources":["../../../../src/components/WriteBar/WriteBar.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useMergeProps } from '../../hooks/useMergeProps';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { warnOnce } from '../../lib/warnOnce';\nimport type { HasDataAttribute, HasRootRef } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { useResizeTextarea } from '../Textarea/useResizeTextarea';\nimport { Headline } from '../Typography/Headline/Headline';\nimport { Title } from '../Typography/Title/Title';\nimport type { TypographyProps } from '../Typography/Typography';\nimport styles from './WriteBar.module.css';\n\nconst warn = warnOnce('WriteBar');\n\nexport interface WriteBarProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRootRef<HTMLDivElement> {\n  /**\n   * @deprecated Since 7.9.0. Вместо этого используйте `slotProps={ textArea: { getRootRef: ... } }`.\n   */\n  getRef?: React.Ref<HTMLTextAreaElement>;\n  /**\n   * Свойства, которые можно прокинуть внутрь компонента:\n   * - `root`: свойства для прокидывания в корень компонента;\n   * - `textArea`: свойства для прокидывания в поле ввода.\n   */\n  slotProps?: {\n    root?: Omit<React.HTMLAttributes<HTMLDivElement>, 'children'> &\n      HasRootRef<HTMLDivElement> &\n      HasDataAttribute;\n    textArea?: React.TextareaHTMLAttributes<HTMLTextAreaElement> &\n      HasRootRef<HTMLTextAreaElement> &\n      HasDataAttribute;\n  };\n  /**\n   * Содержимое, отображаемое слева от поля ввода.\n   */\n  before?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое поверх поля ввода (актуально для iOS).\n   */\n  inlineAfter?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое справа от поля ввода.\n   */\n  after?: React.ReactNode;\n  /**\n   * Вызывается при смене высоты поля ввода.\n   */\n  onHeightChange?: VoidFunction;\n  /**\n   * Добавляет тень вокруг поля ввода.\n   */\n  shadow?: boolean;\n  /**\n   * @deprecated Неиспользуемое свойство.\n   */\n  children?: never;\n}\n\nconst WriteBarTypography = (props: TypographyProps) => {\n  const platform = usePlatform();\n\n  if (platform === 'ios') {\n    return <Title {...props} level=\"3\" weight=\"3\" />;\n  }\n\n  return <Headline weight=\"3\" {...props} />;\n};\n\n/**\n * @see https://vkui.io/components/write-bar\n */\nexport const WriteBar = ({\n  className,\n  style,\n  before,\n  inlineAfter,\n  after,\n  getRootRef,\n  getRef,\n  onHeightChange,\n  shadow = false,\n\n  slotProps,\n  ...restProps\n}: WriteBarProps): React.ReactNode => {\n  /* istanbul ignore if: не проверяем в тестах */\n  if (process.env.NODE_ENV === 'development' && getRef) {\n    warn('Свойство `getRef` устаревшее, используйте `slotProps={ textArea: { getRootRef: ... } }`');\n  }\n\n  const platform = usePlatform();\n\n  const rootProps = useMergeProps(\n    {\n      className,\n      getRootRef,\n      style,\n    },\n    slotProps?.root,\n  );\n\n  const {\n    onChange,\n    getRootRef: getTextAreaRef,\n    ...textAreaRest\n  } = useMergeProps(\n    {\n      className: styles.textarea,\n      getRootRef: getRef,\n      ...restProps,\n    },\n    slotProps?.textArea,\n  );\n\n  const [refResizeTextarea, resize] = useResizeTextarea(onHeightChange, true);\n  const textareaRef = useExternRef(getTextAreaRef, refResizeTextarea);\n\n  React.useEffect(resize, [resize, platform]);\n\n  return (\n    <RootComponent\n      baseClassName={classNames(\n        styles.host,\n        platform === 'ios' && styles.ios,\n        shadow && styles.shadow,\n      )}\n      {...rootProps}\n    >\n      <div className={styles.form}>\n        {hasReactNode(before) && <div className={styles.before}>{before}</div>}\n\n        <div className={styles.formIn}>\n          <WriteBarTypography\n            Component=\"textarea\"\n            onChange={callMultiple(onChange, resize)}\n            getRootRef={textareaRef}\n            {...textAreaRest}\n          />\n          {hasReactNode(inlineAfter) && <div className={styles.inlineAfter}>{inlineAfter}</div>}\n        </div>\n\n        {hasReactNode(after) && <div className={styles.after}>{after}</div>}\n      </div>\n    </RootComponent>\n  );\n};\n"],"names":["React","classNames","hasReactNode","useExternRef","useMergeProps","usePlatform","callMultiple","warnOnce","RootComponent","useResizeTextarea","Headline","Title","styles","warn","WriteBarTypography","props","platform","level","weight","WriteBar","className","style","before","inlineAfter","after","getRootRef","getRef","onHeightChange","shadow","slotProps","restProps","process","env","NODE_ENV","rootProps","root","onChange","getTextAreaRef","textAreaRest","textarea","textArea","refResizeTextarea","resize","textareaRef","useEffect","baseClassName","host","ios","div","form","formIn","Component"],"mappings":"AAAA;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,EAAEC,YAAY,QAAQ,kBAAkB;AAC3D,SAASC,YAAY,QAAQ,8BAA2B;AACxD,SAASC,aAAa,QAAQ,+BAA4B;AAC1D,SAASC,WAAW,QAAQ,6BAA0B;AACtD,SAASC,YAAY,QAAQ,4BAAyB;AACtD,SAASC,QAAQ,QAAQ,wBAAqB;AAE9C,SAASC,aAAa,QAAQ,oCAAiC;AAC/D,SAASC,iBAAiB,QAAQ,mCAAgC;AAClE,SAASC,QAAQ,QAAQ,qCAAkC;AAC3D,SAASC,KAAK,QAAQ,+BAA4B;AAElD,OAAOC,YAAY,wBAAwB;AAE3C,MAAMC,OAAON,SAAS;AAgDtB,MAAMO,qBAAqB,CAACC;IAC1B,MAAMC,WAAWX;IAEjB,IAAIW,aAAa,OAAO;QACtB,qBAAO,KAACL;YAAO,GAAGI,KAAK;YAAEE,OAAM;YAAIC,QAAO;;IAC5C;IAEA,qBAAO,KAACR;QAASQ,QAAO;QAAK,GAAGH,KAAK;;AACvC;AAEA;;CAEC,GACD,OAAO,MAAMI,WAAW,CAAC,EACvBC,SAAS,EACTC,KAAK,EACLC,MAAM,EACNC,WAAW,EACXC,KAAK,EACLC,UAAU,EACVC,MAAM,EACNC,cAAc,EACdC,SAAS,KAAK,EAEdC,SAAS,EACT,GAAGC,WACW;IACd,6CAA6C,GAC7C,IAAIC,QAAQC,GAAG,CAACC,QAAQ,KAAK,iBAAiBP,QAAQ;QACpDb,KAAK;IACP;IAEA,MAAMG,WAAWX;IAEjB,MAAM6B,YAAY9B,cAChB;QACEgB;QACAK;QACAJ;IACF,GACAQ,WAAWM;IAGb,MAAM,EACJC,QAAQ,EACRX,YAAYY,cAAc,EAC1B,GAAGC,cACJ,GAAGlC,cACF;QACEgB,WAAWR,OAAO2B,QAAQ;QAC1Bd,YAAYC;QACZ,GAAGI,SAAS;IACd,GACAD,WAAWW;IAGb,MAAM,CAACC,mBAAmBC,OAAO,GAAGjC,kBAAkBkB,gBAAgB;IACtE,MAAMgB,cAAcxC,aAAakC,gBAAgBI;IAEjDzC,MAAM4C,SAAS,CAACF,QAAQ;QAACA;QAAQ1B;KAAS;IAE1C,qBACE,KAACR;QACCqC,eAAe5C,WACbW,OAAOkC,IAAI,EACX9B,aAAa,SAASJ,OAAOmC,GAAG,EAChCnB,UAAUhB,OAAOgB,MAAM;QAExB,GAAGM,SAAS;kBAEb,cAAA,MAACc;YAAI5B,WAAWR,OAAOqC,IAAI;;gBACxB/C,aAAaoB,yBAAW,KAAC0B;oBAAI5B,WAAWR,OAAOU,MAAM;8BAAGA;;8BAEzD,MAAC0B;oBAAI5B,WAAWR,OAAOsC,MAAM;;sCAC3B,KAACpC;4BACCqC,WAAU;4BACVf,UAAU9B,aAAa8B,UAAUM;4BACjCjB,YAAYkB;4BACX,GAAGL,YAAY;;wBAEjBpC,aAAaqB,8BAAgB,KAACyB;4BAAI5B,WAAWR,OAAOW,WAAW;sCAAGA;;;;gBAGpErB,aAAasB,wBAAU,KAACwB;oBAAI5B,WAAWR,OAAOY,KAAK;8BAAGA;;;;;AAI/D,EAAE"}